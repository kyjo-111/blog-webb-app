<%- include("partials/header.ejs") %>

<div class="container mt-5">
  
  <div class="row mb-4">
    <div class="col-md-8">
      <h1 class="display-4 fw-bold">Recent Stories</h1>
      <p class="lead text-muted">Read the latest thoughts from the community.</p>
    </div>
    <div class="col-md-4 text-end align-self-center">
      <a href="/create" class="btn btn-primary">Write a New Story</a>
    </div>
  </div>

  <hr class="mb-5">

  <% if (posts.length === 0) { %>
      
      <div class="text-center py-5">
        <h3 class="text-muted mb-4">It's quiet in here...</h3>
        <p class="mb-4">Be the first to share your story!</p>
        <a href="/create" class="btn btn-outline-primary">Start Writing</a>
      </div>

  <% } else { %>

      <div class="row row-cols-1 row-cols-md-2 g-4">
        
        <% posts.forEach(function(post, index) { %>
            
            <div class="col">
              
              <div class="card h-100 shadow-sm border-0">
                <div class="card-body d-flex flex-column">
                  
                  <h5 class="card-title fw-bold"><%= post.title %></h5>
                  
                  <h6 class="card-subtitle mb-2 text-muted">
                    <%= post.date || new Date().toLocaleDateString() %>
                  </h6>
                  
                  <p class="card-text mt-3">
                    <%= post.content.substring(0, 100) + "..." %>
                  </p>
                  
                  <div class="mt-auto pt-3 d-flex justify-content-between align-items-center">
                    
                    <a href="#" class="btn btn-sm btn-outline-dark">Read</a>

                    <div>
                        <a href="/edit/<%= post.id %>" class="btn btn-sm btn-link text-muted text-decoration-none me-2">Edit</a>
                        
                        <form action="/delete" onsubmit="return confirm('Are you sure you want to delete this post?');" method="POST" style="display:inline;">
                            <input type="hidden" name="postIndex" value="<%= index %>">
                            <button type="submit" class="btn btn-sm btn-outline-danger">Delete</button>
                        </form>
                    </div>

                  </div> </div> </div> </div> <% }); %> </div> <% } %>

</div>

<%- include("partials/footer.ejs") %>